{
  "db_name": "PostgreSQL",
  "query": "\nWITH per_tx AS (\n  SELECT\n    COALESCE(fee_nanos,0) AS fee,\n    NULLIF(size_bytes,0) AS size,\n    num_inputs,\n    (CASE WHEN size_bytes>0 THEN COALESCE(fee_nanos,0)::numeric / size_bytes::numeric ELSE NULL END) AS fee_rate\n  FROM public.txs WHERE block_height = $1\n),\naggs AS (\n  SELECT\n    SUM(fee)::bigint AS total_fee,\n    AVG(NULLIF(num_inputs,0))::double precision AS avg_inputs,\n    (PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY fee_rate))::double precision AS median_fee_rate\n  FROM per_tx\n)\nSELECT\n  COALESCE(total_fee,0)::bigint AS total_fee,\n  COALESCE(avg_inputs,0::double precision) AS avg_inputs,\n  COALESCE(median_fee_rate,0::double precision) AS median_fee_rate\nFROM aggs\n",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "total_fee",
        "type_info": "Int8"
      },
      {
        "ordinal": 1,
        "name": "avg_inputs",
        "type_info": "Float8"
      },
      {
        "ordinal": 2,
        "name": "median_fee_rate",
        "type_info": "Float8"
      }
    ],
    "parameters": {
      "Left": [
        "Int8"
      ]
    },
    "nullable": [
      null,
      null,
      null
    ]
  },
  "hash": "4c75c891ed14bd57c35a3957ffc38ddae3bb446b4cf5056cd00bd98acbf8c54c"
}
